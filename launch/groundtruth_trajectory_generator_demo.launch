<launch>
  
    <arg name="input_bagfile"       default="/media/mike/MIKEMDATA3/2021_09_27_POST_EVENT_TEST/H01_ouster_imu_tfs_1.bag"/>
    <arg name="cloud_topic"         default="/H01/horiz/os_cloud_node/points"/>
    <arg name="cloud_throttle_rate" default="0.1"/>
    <arg name="output_cloud"        default="false"/>
    <arg name="gt_input_pcdfile"    default="/media/mike/MIKEMDATA3/2021_09_27_POST_EVENT_TEST/systems_final.pcd"/>
    <arg name="gt_cloud_frame"      default="world"/>
    <arg name="output_gt_cloud"     default="true"/>
    <arg name="gt_cloud_topic"      default="/systems_final_cloud"/>
    <arg name="gt_path_topic"       default="/systems_final_path"/>
    <arg name="output_bagfile"      default="/media/mike/MIKEMDATA3/2021_09_27_POST_EVENT_TEST/systems_final.bag"/>
    <arg name="require_tfs"         default="true"/>
    <arg name="publish_path"        default="true"/>

    <arg name="goicp_config_file"       default="$(find goicp)/demo/config.txt"/>
    <arg name="goicp_downsample"        default="500"/>
    <arg name="goicp_publish_clouds"    default="true"/>
    <arg name="goicp_always_update_dt"  default="false"/>
    <arg name="goicp_server_timeout"    default="0.0"/>

    <arg name="enable_debug"  default="false"/>
    <arg name="launch_prefix" default="gdb -ex run --args" if="$(eval arg('enable_debug'))"/>
    <arg name="launch_prefix" default="" unless="$(eval arg('enable_debug'))"/>

    <node pkg="pcl_ros_toolbox" type="groundtruth_trajectory_generator_node" name="groundtruth_trajectory_generator"  output="screen" launch-prefix="$(arg launch_prefix)">
        <param name="input_bagfile"        value="$(arg input_bagfile)"/>
        <param name="cloud_topic"          value="$(arg cloud_topic)"/>
        <param name="cloud_throttle_rate"  value="$(arg cloud_throttle_rate)"/>
        <param name="output_cloud"         value="$(arg output_cloud)"/>
        <param name="gt_input_pcdfile"     value="$(arg gt_input_pcdfile)"/>
        <param name="gt_cloud_frame"       value="$(arg gt_cloud_frame)"/>
        <param name="output_gt_cloud"      value="$(arg output_gt_cloud)"/>
        <param name="gt_cloud_topic"       value="$(arg gt_cloud_topic)"/>
        <param name="gt_path_topic"        value="$(arg gt_path_topic)"/>
        <param name="output_bagfile"       value="$(arg output_bagfile)"/>
        <param name="require_tfs"          value="$(arg require_tfs)"/>
        <param name="publish_path"         value="$(arg publish_path)"/>
    </node>

    <node pkg="goicp" type="go_icp_server_node" name="go_icp_server" output="screen" launch-prefix="$(arg launch_prefix)">
        <param name="config_filename"   value="$(arg goicp_config_file)"/>
        <param name="nd_downsampled"    value="$(arg goicp_downsample)"/>
        <param name="publish_clouds"    value="$(arg goicp_publish_clouds)"/>
        <param name="always_update_dt"  value="$(arg goicp_always_update_dt)"/>
        <param name="server_timeout"    value="$(arg goicp_server_timeout)"/>
    </node>

</launch>